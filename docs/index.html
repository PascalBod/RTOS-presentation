<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="icon" href="favicon.ico">

    <title>RTOS for ML</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/pb.css">
    <link rel="stylesheet" href="pres-style.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css">
  </head>

  <body>
    <div class="reveal">
      <div class="slides">

        <!-- -------------------- Preambule ---------------------------------------- -->
        
        <section>
          <h2>Introduction to RTOS for ML</h2>
          <h5>Pascal Bodin</h5>
          <img src="images/energy-system.png" height="350">
          <div class="pbverysmall">To enter the presentation, click the arrow in bottom right corner</div>
        </section>
        <section>
          <h3>Document history</h3>
          <table class="pbsmaller">
            <thead>
              <tr>
                <th>When</th>
                <th>What</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>20-Aug-2024</td>
                <td>GPIO output: exercise 03</td>
              </tr>
              <tr>
                <td>18-Aug-2024</td>
                <td>GPIO input: exercise 02</td>
              </tr>
              <tr>
                <td>17-Aug-2024</td>
                <td>App architecture introduced by exercise 01</td>
              </tr>
              <tr>
                <td>16-Aug-2024</td>
                <td>GPIO section</td>
              </tr>
              <tr>
                <td>07-Aug-2024</td>
                <td>Target is now EFR32MG24</td>
              </tr>
              <tr>
                <td>30-Jul-2024</td>
                <td>First practice session</td>
              </tr>
              <tr>
                <td>29-Jul-2024</td>
                <td>Introductory part</td>
              </tr>
            </tbody>
          </table>
        </section>
        
        <section>
          <h3>Licenses</h3>
          <h4>Presentation</h4>
            <p class="pbcenter"><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
              Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a></p>
          <h4>Source code</h4>
            <p class="pbcenter"><a href="https://www.gnu.org/licenses/gpl-3.0.html#license-text"
                  target="_blank"">GNU General Public License v3</a></p>
        </section>
        <section>
          <h3>Credits</h3>
          <ul>
            <li><a target="_blank" href="https://github.com/hakimel/reveal.js">reveal.js</a> - Copyright (C)
              2020 Hakim El Hattab</li>
            <li><a href="https://www.flaticon.com/authors/freepik" title="Freepik" target="_blank">Freepik</a>
              from <a href="https://www.flaticon.com/" title="Flaticon" target="_blank">www.flaticon.com</a>
            </li>
            <li><a href="https://www.flaticon.com/free-icons/electricity" title="electricity icons"
                 target="_blank">Electricity icons created by Dewi Sari - Flaticon</a>
            </li>
          </ul>
        </section>
        
        <section>
          <h3>How to navigate</h3>
          <ul>
            <li>Use the right and left arrows (in bottom right corner)
            <li>Overview: press "O" letter - navigate with arrow keys - "ESC" or click on slide to exit</li>
            <li>Full screen: press "F" letter - "ESC" to exit</li>
          </ul>
        </section>

        <!-- -------------------- Contents ---------------------------------------- -->
        
        <section>
          <h3>Contents</h3>
          <div class="pbcolumns">
            <div class="pbsmaller">
              <ul>
                <li><a href="#/foreword">Foreword</a></li>
                <li><a href="#/introduction">Introduction</a>
                  <ul>
                    <li><a href="#/hardwareProgress">Hardware progress</a></li>
                    <li><a href="#/embeddedApplications">Embedded applications</a></li>
                  </ul>
                </li>
                <li><a href="#/microcontrollerBoard">Microcontroller board</a>
                  <ul>
                    <li><a href="#/microcontrollerBoardReminders">Reminders</a></li>
                    <li><a href="#/microcontrollerArchitecture">Microcontroller</a></li>
                    <li><a href="#/boardArchitecture">Board architecture</a></li>
                    <li><a href="#/importantCharacteristics">Important characteristics</a></li>
                    <li><a href="#/someUcFamilies">Some ÂµC families</a></li>
                  </ul>
                </li>
                <li><a href="#/softwareDevelopment1">Software development - part 1</a>
                  <ul>
                    <li><a href="#/crossDevelopment">Cross development</a></li>
                    <li><a href="#/exercise01"><b>Practice: Build and run an Hello World application</b></a></li>
                  </ul>
                </li>
                <li><a href="#/peripherals">Peripherals</a></li>
              </ul>
            </div>
            <div class="pbsmaller">
              <ul>
                <li><a href="#/interfaces">Interfaces</a>
                  <ul>
                    <li><a href="#/gpioInterface">GPIO</a></li>
                    <li><a href="#/exercise02"><b>Practice: display button state changes</b></a></li>
                    <li><a href="#/exercise03"><b>Practice: make the red LED blink</b></a></li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
          <div class="pbverysmall">
            To be continued...
          </div>
        </section>
        
        <!-- -------------------- Foreword ---------------------------------------- -->
        
        <section id="foreword">
          <h2>Foreword</h2>
        </section>
        
        <section>
          <h3>Who am I?</h3>
          <ul>
            <li><a href="https://systev.com" target="_blank">
                Independent consultant and freelancer - connected devices</a> <br />
              <a href="https://baylibre.com/" target="_blank">
                <img src="images/logo_baylibre_rvb_400-300x104.png.webp" width="160"></a>
              &nbsp;
              <a href="https://www.connectedcycle.com" target="_blank">
                <img src="images/logo-connectedCycle.png"></a>
              &nbsp;
              <a href="https://www.ackl.io" target="_blank">
                <img src="images/logo-acklio.png"></a>
              &nbsp;
              <a href="https://www.ademe.fr/en/frontpage/" target="_blank">
                <img src="images/logoademe2020_gb_rvb.webp" height="100"></a>                                           
            </li>
            <li>Beforehand: software engineer, project leader, team manager, co-founder, technical expert</li>
            <li>
              McDonnell Douglas Informations Systems, Digital Equipement Corporation (DEC), Orange
            </li>
            <li>
              Co-founded (and closed down) two companies
            </li>
            <li>First connected devices project: in 1990</li>
          </ul>
        </section>
        
        <section>
          <h3>More information</h3>
          <ul>
            <li><a href="https://fr.systev.com" target="_blank">Systev</a></li>
            <li><a href="https://www.linkedin.com/in/pascalbodin/" target="_blank">LinkedIn</a></li>
            <li><a href="https://github.com/PascalBod" target="_blank">GitHub</a></li>
            <li><a href="https://mastodon.world/@pascalb06" target="_blank">Matomo</a></li>
            <li><a href="https://twitter.com/pascalbod06" target="_blank">X</a></li>
          </ul>
        </section>
        
        <section>
          <h3>Goal</h3>
          <ul>
            <li>Understand how to develop, run and debug embedded applications</li>
            <li>Understand the benefits (and drawbacks) of Real-Time Operating Systems</li>
            <li>Understand how to get data from sensors and how to store it</li>
          </ul>
          <div class="fragment">
            <h3>Non-goal</h3>
            <ul>
              <li>How to develop embedded ML applications</li>            
            </ul>
          </div>
        </section>
        
        <section>
          <h3>Needs of ML applications</h3>
          <div class="r-stack">
            <div>
              <img src="images/mlNeeds-0.png" height="400">
            </div>
            <div>
              <img src="images/mlNeeds-1.png" height="400" class="fragment fade-in-then-out">
            </div>
          </div>
        </section>
        
        <section>
          <h4>Technical domains</h4>
          <img src="images/technicalDomains-1.png" height="150">
        </section>
        
        <section>
          <h4>Closer look - Computer Science</h4>
          <div class="r-stack">
            <div>
              <img src="images/technicalDomainsComputerScience-0.png" height="500">
            </div>
            <div>
              <img src="images/technicalDomainsComputerScience-1.png" height="500"
                   class="fragment fade-in-theen-out">
            </div>
          </div>
          <div class="pbverysmall">
            HAL: Hardware Abstraction Layer - RTOS: Real-Time Operating System
          </div>
        </section>
        
        <section>
            <h4>Closer look - Communication</h4>
            <div class="r-stack">
              <div>
                <img src="images/technicalDomainsCommunication-0.png" height="300">
              </div>
              <div>
                <img src="images/technicalDomainsCommunication-1.png" height="300"
                     class="fragment fade-in-then-out">
              </div>
            </div>
        </section>

        <section>
            <h4>Closer look - Electronics</h4>
            <div class="r-stack">
              <div>
                <img src="images/technicalDomainsElectronics-0.png" height="400">
              </div>
              <div>
                <img src="images/technicalDomainsElectronics-1.png" height="400"
                     class="fragment fade-in-then-out">
               </div>
            </div>
            <div class="pbverysmall">
              MCU: MicroController Unit
            </div>
        </section>

        <!-- -------------------- Introduction ---------------------------------------- -->
        
        <section id="introduction">
          <h2>Introduction</h2>
        </section>
        <section id="hardwareProgress">
          <h3>Hardware progress</h3>
        </section>
        <section>
          <h4>1982 - Cray X-MP</h4>
          <img src="images/CRAY-X-MP-1-1.jpg" height="500">
          <div class="pbverysmall">Source: <a href="https://www.hpe.com/us/en/compute/hpc/cray.html"
                                              title="HPE" target="_blank">HPE</a></div>
        </section>
        <section>
          <ul>
            <li>World most powerful computer</li>
            <li>0.94 GFLOPS (giga floating-point operations per second)</li>
            <li>Price: around US$15 million (would be US$45 million in 2022)</li>
          </ul>
          <div class="pbverysmall">Sources: 
            <a href="https://www.hpe.com/us/en/compute/hpc/cray.html"
               title="HPE" target="_blank">HPE</a>
            <a href="https://www2.cisl.ucar.edu/ncar-supercomputing-history/cx"
               title="NCAR" target="_blank">NCAR</a>
          </div>                    
        </section>
        
        <section>
          <h4>2022 - iPhone 14</h4>
          <img src="images/iphone-14-model-unselect-gallery-2-202303_GEO_US.png" height="500">
          <div class="pbverysmall">Source: <a href="https://www.apple.com/iphone-14/" title="Apple"
                                              target="_blank">Apple</a></div>
        </section>
        
        <section>
          <ul>
            <li>A15 Bionic chip with 5-core GPU: 1.7 TFLOPS</li>
            <li>Price: US$800</li>
          </ul>
          <div class="pbverysmall">Sources: 
            <a href="https://www.apple.com/shop/buy-iphone/iphone-14"
               title="Apple" target="_blank">Apple</a>
            <a href="https://www.cpu-monkey.com/en/cpu-apple_a15_bionic_5_gpu"
               title="cpu-monkey" target="_blank">cpu-monkey</a>
          </div>
        </section>
        
        <section>
          <p>In 40 years:</p>
          <ul>
            <li>Processing power multiplied by around 1,700</li>
            <li>Cost divided by around 56,000</li>
          </ul>
          <div class="pbverysmall">
            (Beware: comparing processing power in a really correct way is more complex than simply looking at the two FLOPS values. But, anyway, this gives an idea.)
          </div>
        </section>
        <section>
          <p class="pbcenter">What do the years to come have in store?!</p>
        </section>
        <section id="embeddedApplications">
          <h3>Embedded applications</h3>
        </section>
        
        <section>
          <h4>1969 - The computer that made it possible to land on the Moon</h4>
          <img src="images/agc_dsky.jpg">
          <div class="pbverysmall">Source: <a href="http://klabs.org/history/history_docs/mit_docs/agc.htm"
                                              title="klabs.org" target="_blank">klabs.org</a></div>
        </section>
        <section>
          <ul>
            <li>Weight: aroung 32 kg (without the user interface)</li>
            <li>Power supply: 28 V CC - 70 W</li>
            <li>Permanent memory: 36 Kwords</li>
            <li>Erasable memory: 2 Kwords</li>
            <li>Clock: 1 MHz (83 kHz instruction cycle time)</li>
            <li>Simple operating system, with priority handling</li>
          </ul>
        </section>
        
        <section>
          <p class="pbcenter">Compared to current configurations:</p>
          <ul>
            <li>Very little memory</li>
            <li>Very little processing power</li>
          </ul>
          <p class="pbcenter">Yet it allowed to bring human beings to the Moon.</p>
        </section>
        
        <section>
          <p class="pbcenter">It's not because you don't have a lot of memory and processing power
            that you can't develop great applications &#x1F642;
          </p>
        </section>
        
        <section>
          <p class="pbcenter">A modern microcontroller with similar processing power:</p>
          <img src="images/pic18f47k42.png" height="100">
          <br />
          <ul>
            <li>Flash memory: 128 Ko</li>
            <li>RAM: 8 Ko</li>
            <li>Clock: up to 64 MHz</li>
            <li>Power consumption: 30 mW (microcontroller alone)</li>
            <li>Power consumption in sleep mode: 0,1 &mu;W</li>
            <li>Price: around US$3.00</li>
          </ul>
          <div class="pbverysmall">
            Note: this microcontroller is not radiation hardened, does not provide all required I/O, does
            not provide all required reliability mechanisms, etc.
          </div>
          <div class="pbverysmall">Source : <a href="https://www.microchip.com/wwwproducts/en/PIC18F47K42"
                                               title="Microchip" target="_blank">Microchip</a></div>
        </section>

        <!-- -------------------- Microcontroller board ---------------------------------------- -->
        
        <section id="microcontrollerBoard">
          <h3>Microcontroller board</h3>
        </section>
        
        <section id="microcontrollerBoardReminders">
          <h4>Reminders - Memory content retention</h4>
          <ul>
            <li>Volatile memory: content is lost when the system turns off - RAM</li>
            <li>Non-volatile memory: content is retained - Flash, EEPROM</li>
          </ul>
          <div class="pbverysmall">
          RAM: Random Access Memory - EEPROM: Electrically Erasable Programmable Read-Only Memory
          </div>
        </section>
        
        <section>
          <h4>Reminders - Memory hierarchy</h4>
          <p>From most rapid access to slowest access:</p>
          <ul>
            <li>Registers - inside the CPU</li>
            <li>Cache - inside and outside the CPU - usually not present in MCU</li>
            <li>Main memory</li>
            <li>Disk - magnetic or flash</li>
          </ul>
          <div class="pbverysmall">
          CPU: Central Processing Unit - MCU: MicroController Unit
          </div>
        </section>
        
        <section>
          <ul>
            <li>Registers: RAM</li>
            <li>Cache: RAM</li>
            <li>Main memory: RAM + flash</li>
          </ul>
        </section>
        
        <section id="microcontrollerArchitecture">
          <h4>Microcontroller</h4>
          <ul>
            <li>A computer in a chip:
              <ul>
                <li>Central Processing Unit (CPU)</li>
                <li>Read-only memory (Flash memory)</li>
                <li>Read/write memory (RAM - Random Access Memory)</li>
                <li>Clocks</li>
                <li>Energy management</li>
                <li>Peripherals and interfaces:
                  <ul>
                    <li>Analog I/O</li>
                    <li>Digital I/O</li>
                    <li>Timers</li>
                    <li>Serial interfaces</li>
                    <li>etc.</li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </section>
        
        <section>
          <p>An example of MCU architecture:</p>
          <img src="images/mcuArchitecture.png">
        </section>
        
        <section id="boardArchitecture">
          <h4>Board architecture</h4>
          <img src="images/deviceArchitecture.png">
        </section>
        
        <section>
          <div class="row">
            <div class="column">
              <img src="images/deviceArchitecture.png">
            </div>
            <div class="column">
              <div class="r-stack">
                <div class="fragment fade-in-then-out">
                  <ul>
                    <li>Microcontroller
                      <ul>
                        <li>CPU + memory</li>
                        <li>Some peripherals (e.g. timers)</li>
                        <li>Interfaces (e.g. serial interfaces, GPIO)</li>
                      </ul>
                    </li>
                    <li>Power system</li>
                  </ul>
                </div>
                <div class="fragment fade-in-then-out">
                  <ul>
                    <li>Wireless communication
                      <ul>
                        <li>Optional</li>
                        <li>May be hosted by the microcontroller (Wi-Fi, Bluetooth, LoRa, etc.)
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="fragment fade-in-then-out">
                  <ul>
                    <li>Optionally:
                      <ul>
                        <li>Additional interfaces</li>
                        <li>Peripherals (e.g. sensors)</li>
                        <li>Positioning (e.g. GNSS)</li>
                        <li>User interface</li>
                        <li>Data storage</li>
                      </ul>
                    </li>
                  </ul>
                  <div class="pbverysmall">GNSS: Global Navigation Satellite System</div>
                </div>
                <div class="fragment fade-in_then-out">
                  <ul>
                    <li>Not depicted: optional, additional memory, outside of the microcontroller
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </section>
        
        <section id="importantCharacteristics">
          <h4>Important board/microcontroller characteristics?</h4>
          <ul>
            <li>Depend on the target application!</li>
            <li>Example:
              <ul>
                <li>General Purpose Input/Output (GPIO)</li>
                <li>Serial links</li>
                <li>Serial buses (SPI, I2C, etc.)</li>
                <li>Analog to Digital Converters (ADC), Digital to Analog Converters (DAC)</li>
                <li>Analog blocks</li>
                <li>Instruction cycle time</li>
                <li>Memory (size, type, expandable...)</li>
                <li>Registers size (8/16/32 bits)</li>
                <li>Packaging</li>
                <li>etc.</li>
              </ul>
            </li>
          </ul>
        </section>
        
        <section>
          <h4>Other important characteristics: hardware tools</h4>
          <ul>
            <li>Development board</li>
            <li>Programmer, debugger</li>
            <li>Open source hardware</li>
          </ul>
        </section>
        
        <section>
          <h4>Other important characteristics: software tools</h4>
          <ul>
            <li>Cross-compilation toolchain</li>
            <li>Integrated Development Environment (IDE)</li>
            <li>Open source software</li>
          </ul>
        </section>
        
        <section>
          <h4>Other important characteristics: support</h4>
          <ul>
            <li>Professional support</li>
            <li>Active community (forums, examples...)</li>
          </ul>
        </section>
        
        <section id="someUcFamilies">
          <h4>Some common microcontroller families</h4>
        </section>
        
        <section>
          <h4>Arm</h4>
          <ul>
            <li>UK company created in 1990</li>
            <li><b>There isn't any Arm microcontroller</b></li>
            <li>Arm provides Intellectual Property (IP) blocks, under a licensing agreement</li>
            <li>Among these blocks: RISC microcontrollers cores</li>
            <li>For the IoT (low power, low cost): Cortex-M family</li>
          </ul>
          <div class="pbverysmall">RISC: Reduced Instruction Set Computer</div>
        </section>
        
        <section>
          <h4>Shipped processors</h4>
          <ul>
            <li>end 2020: 180 billions</li>
            <li>including 6.7 billions in Q4 2020</li>
            <li>including 4.4 billions of Cortex-M in Q4 2020</li>
          </ul>
          <div class="pbverysmall">Source: 
            <a href="https://www.arm.com/company/news/2021/02/arm-ecosystem-ships-record-6-billion-arm-based-chips-in-a-single-quarter"
               title="Arm" target="_blank">Arm</a>
          </div>
          <ul>
            <li>Sep-2022: more than 250 billions</li>
          </ul>
          <div class="pbverysmall">Source: 
            <a href="https://www.arm.com/company/news/2023/02/arm-announces-q3-fy22-results"
               title="Arm" target="_blank">Arm</a>
          </div>
          <p>Arm processor architecture is more popular than any other architecture.</p>
        </section>
        
        <section>
          <p class="pbcenter">Some Cortex-M licensees:</p>
          <ul>
            <li><a href="https://www.infineon.com/cms/en/product/microcontroller/"
                   target="_blank">Infineon</a></li>
            <li><a href="https://www.microchip.com/en-us/products/microcontrollers-and-microprocessors/32-bit-mcus/pic32-32-bit-mcus/pic32cm-mc"
                   target="_blank">Microchip</a></li>
            <li><a href="https://www.nordicsemi.com/Products"
                   target="_blank">Nordic Semiconductor</a></li>
            <li><a href="https://www.nxp.com/products/processors-and-microcontrollers/arm-microcontrollers:ARM-MICROCONTROLLERS"
                   target="_blank">NXP Semiconductors</a></li>
            <li><a href="https://www.renesas.com/eu/en/products/microcontrollers-microprocessors/ra-cortex-m-mcus"
                   target="_blank">Renesas</a></li>
            <li><a href="https://www.silabs.com/"
                   target="_blank">Silicon Labs</a></li>
            <li><a href="https://www.st.com/en/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html"
                   target="_blank">STMicroelectronics</a></li>
            <li><a href="https://www.ti.com/microcontrollers-mcus-processors/microcontrollers/arm-based-microcontrollers/overview.html"
                   target="_blank">Texas Instruments</a></li>
            <li>etc.</li>
          </ul>
        </section>
        
        <section>
          <h4>Arm cores</h4>
          <div class="r-stack">
            <div>
              <img src="images/armProcessorFamily.png" height="500">
            </div>
            <div class="fragment fade-in-then-out">
              <img src="images/armProcessorFamilyCortexM.png" height="500">
            </div>
          </div>
          <div class="pbverysmall">
            Diagram a little bit old (2017) - new models are available
          </div>
          <div class="pbverysmall">Source: <a
                                             href="https://community.arm.com/cn/b/blog/posts/2017-cortex-m-whitepaper-english"
                                             title="Cortex-M for Beginners" target="_blank">Cortex-M for Beginners</a></div>
        </section>
        
        <section>
          <h4>Instruction sets</h4>
          <img src="images/armProcessorFamilyCortexMInstructions.png" height="500">
          <div class="pbverysmall">Source: <a
                                             href="https://community.arm.com/cn/b/blog/posts/2017-cortex-m-whitepaper-english"
                                             title="Cortex-M for Beginners" target="_blank">Cortex-M for Beginners</a></div>
        </section>
        
        <section>
          <h4>Provided elements</h4>
          <img src="images/armCortexMArchitecture.png" height="500">
          <div class="pbverysmall">Source: <a
                                             href="https://community.arm.com/cn/b/blog/posts/2017-cortex-m-whitepaper-english"
                                             title="Cortex-M for Beginners" target="_blank">Cortex-M for Beginners</a></div>
        </section>
        
        <section>
          <h4>Example: STMicroelectronics - STM32 family</h4>
        </section>
        
        <section>
          <img src="images/STM32Series.png" height="600">
          <div class="pbverysmall">Source: <a
                                             href="https://www.st.com/en/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus.html"
                                             title="STMicroelectronics" target="_blank">STMicroelectronics</a></div>
        </section>
        
        <section>
          <h4>STM32L073RZ</h4>
        </section>
        
        <section>
          <img src="images/stm32l073xz_192k-medium.jpg">
          <div class="pbverysmall">Source: <a
                                             href="https://www.st.com/en/microcontrollers-microprocessors/stm32l073rz.html"
                                             title="STMicroelectronics" target="_blank">STMicroelectronics</a></div>
        </section>
        
        <section>
          <img src="images/stm32l073rz.png" height="600">
          <div class="pbverysmall">Source: <a
                                             href="https://www.st.com/en/microcontrollers-microprocessors/stm32l073rz.html#documentation"
                                             title="STMicroelectronics" target="_blank">STMicroelectronics</a></div>
        </section>
        
        <section>
          <ul>
            <li>Price: US$6.95 (unit) - US$2.66 (10,000)</li>
          </ul>
        </section>
        
        <section>
          <h5>Development board</h5>
          <img src="images/nucleo-l073rg.png">
          <p class="pbcenter">Price: US$13</p>
          <div class="pbverysmall">Source: <a
                                             href="https://www.st.com/content/st_com/en/products/evaluation-tools/product-evaluation-tools/mcu-mpu-eval-tools/stm32-mcu-mpu-eval-tools/stm32-nucleo-boards/nucleo-l073rz.html"
                                             title="STMicroelectronics" target="_blank">STMicroelectronics</a></div>
        </section>
        
        <section>
          <h4>STM32WL55</h4>
        </section>
        
        <section>
          <img src="images/stm32wlOverview.jpeg">
          <div class="pbverysmall">Source: <a
                                             href="https://www.st.com/content/st_com/en/products/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus/stm32-wireless-mcus/stm32wl-series.html"
                                             title="STMicroelectronics" target="_blank">STMicroelectronics</a></div>
        </section>
        <section>
          <img src="images/stm32wl55Architecture.png" height="600">
          <div class="pbverysmall">Source: <a
                                             href="https://www.st.com/content/st_com/en/products/microcontrollers-microprocessors/stm32-32-bit-arm-cortex-mcus/stm32-wireless-mcus/stm32wl-series.html"
                                             title="STMicroelectronics" target="_blank">STMicroelectronics</a></div>
        </section>
        
        <section>
          <ul>
            <li>Price: US$9.25 (unit) - US$4.54 (10,000)</li>
          </ul>
        </section>
        
        <section>
          <h5>Development board</h5>
          <img src="images/nucleowl55jc.jpg" height="400">
          <p class="pbcenter">US$42</p>
          <div class="pbverysmall">Source: <a
                                             href="https://www.st.com/content/st_com/en/products/evaluation-tools/product-evaluation-tools/mcu-mpu-eval-tools/stm32-mcu-mpu-eval-tools/stm32-nucleo-boards/nucleo-wl55jc.html"
                                             title="STMicroelectronics" target="_blank">STMicroelectronics</a></div>
        </section>
        
        <section>
          <h4>Example: Silicon Labs - EFR32 family</h4>
        </section>

        <section>
          <img src="images/siliconLabsWirelessProducts.png">
          <div class="pbverysmall">Source: 
            <a
              href="https://www.silabs.com/products"
              title="Silicon Labs Wireless SoCs"
              target="_blank">Silicon Labs Wireless SoCs</a></div>
        </section>
        
        <section>
          <ul>
            <li>Bluetooth: EFR32BG21, EFR32BG22, EFR32BG24, EFR32BG26, EFR32BG27</li>
            <li>Wi-Fi: SiWx915, SiWx917, RS9116, WF200</li>
            <li>Thread: EFR32MG12, EFR32MG13, EFR32MG21, EFR32MG24</li>
            <li>Etc.</li>
          </ul>
        </section>
        
        <section>
          <h4>EFR32MG24</h4>
        </section>
        
        <section>
          <img src="images/efr32mg24-block-diagram.png">
          <div class="pbverysmall">Source: 
            <a
              href="https://www.silabs.com/documents/public/data-sheets/efr32mg24-datasheet.pdf"
              title="EFR32MG24 Datasheet"
              target="_blank">EFR32MG24 Datasheet</a></div>
        </section>
        
        <section>
          <ul>
            <li>Price: around US$7 (unit)</li>
          </ul>
        </section>
        
        <section>
          <h5>Development board</h5>
          <img src="images/efr32bg24-dev-kit.png" height="400">
          <p class="pbcenter">US$79</p>
          <div class="pbverysmall">Source: 
            <a
              href="https://www.silabs.com/documents/public/user-guides/ug524-brd2601b-user-guide.pdf"
              title="xG24 Dev Kit User's Guide" 
              target="_blank">xG24 Dev Kit User's Guide</a></div>
        </section>
        
        <section>
          <h4>Espressif - ESP family</h4>
          <img src="images/Espressif_Standard_Logo_CN_Horizontal.png" width="160"">
        </section>
        
        <section>
          <h4>Espressif family</h4>
          <ul class="pbsmaller">
            <li>ESP32-P Series - high-power RISC-V dual-core + low-power single-core</li>
            <li>ESP32-S Series - Xtensa LX7 dual-cor or single-core - Wi-Fi, BLE</li>
            <li>ESP32-C Series - RISC-V dual-core or single-core - Wi-Fi (2.4 GHz / 5 GHz), BLE, IEEE 802.15.4</li>
            <li>ESP32-H Series - RISC-V single-core</li>
            <li>ESP32 Series - Xtensa LX6 dual-core or single-core - Wi-Fi, Bluetooth, BLE</li>
          </ul>
          <div class="pbverysmall">
          BLE: Bluetooth Low Energy
          </div>
          <div  class="pbverysmall">
          IEEE 802.15.4: physical layer and MAC layer for Zigbee, 6LowPAN, Thread, Matter, etc.
          </div>
          <div class="pbverysmall">Source: <a
                                             href="https://www.espressif.com/en/products/socs"
                                             title="Espressif" target="_blank">Espressif</a>
          </div>
        </section>
        
        <section>
          <h4>ESP32-C6FH4</h4>
          <img src="images/esp32c6-functionalBlockDiagram.png" height="550">
          <div class="pbverysmall">Source: 
               <a href="https://www.espressif.com/sites/default/files/documentation/esp32-c6_datasheet_en.pdf"
                  title="ESP32-C6 Datasheet" target="_blank">ESP32-C6 Datasheet</a>
          </div>
        </section>
        
        <section>
          <h4>Some of the features</h4>
          <ul>
            <li>High-power RISC-V processor - clock up to 160 MHz</li>
            <li>Low-power RISC-V processor - clock up to 20 MHz</li>
            <li>L1 cache: 32 KB</li>
            <li>ROM: 320 KB</li>
            <li>Hig-power SRAM: 512 KB</li>
            <li>Low-power SRAM: 16 KB</li>
            <li>Flash: 4 MB</li>
          </ul>
        </section>
        
        <section>
          <ul>
            <li>Price: US$2.05</li>
          </ul>
        </section>
        
        <section>
          <h5>Development board</h5>
          <img src="images/esp32c6-devkitm-1-isometric.png" height="300">
          <div class="pbverysmall">Source: 
               <a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32c6/esp32-c6-devkitm-1/user_guide.html"
                  title="ESP32-C6-DevKitM-1" target="_blank">ESP32-C6-DevKitM-1</a></div>
        </section>

        <section>
          <ul>
            <li>Price: US$7.96</li>
          </ul>
        </section>
        
        <!-- -------------------- Software development - part 1 ---------------------------------------- -->
        
        <section id="softwareDevelopment1">
          <h3>Software development - part 1</h3>
        </section>
        
        <section id="crossDevelopment">
          <h4>Cross development</h4>
          <img src="images/crossDevEfr32bg24.png">
          <div class="pbverysmall">Icons made by 
            <a href="https://www.flaticon.com/authors/freepik"
               title="Freepik" target="_blank">Freepik</a> from 
            <a href="https://www.flaticon.com/"
               title="Flaticon" target="_blank">www.flaticon.com</a></div>
        </section>
        
        <section>
          <h4>Reminders</h4>
        </section>

        <section>
          <h4>Usual development</h4>
          <div class="r-stack">
            <div class="fragment fade-out" data-fragment-index="0">
              <img src="images/build1.png">
            </div>
            <div class="fragment fade-in-then-out" data-fragment-index="0">
              <img src="images/build2.png">
            </div>
            <div class="fragment fade-in-then-out">
              <img src="images/build3.png">
            </div>
            <div class="fragment fade-in-then-out">
              <img src="images/build4.png">
            </div>
            <div class="fragment fade-in-then-out">
              <p class="pbcenter">Then you run the executable file.</p>
            </div>
          </div>
        </section>
        
        <section>
          <p class="pbcenter"><b>Toolchain</b>: compiler + linker + other utilities</p>
        </section>
        
        <section>
          <h4>Cross development for microcontroller board</h4>
          <div class="r-stack">
            <div class="fragment fade-out" data-fragment-index="0">
              <img src="images/build5.png">
            </div>
            <div class="fragment fade-in-then-out" data-fragment-index="0">
              <img src="images/transferExecutable.png">
            </div>
          </div>
        </section>
        
        <section>
          <p>Transferring the executable file to the microcontroller board can be done in several ways:</p>
          <ul>
            <li>Over a debug interface</li>
            <li>Over a serial link while the microcontroller runs a <em>bootloader</em></li>
            <li>Over a wireless connection while the microcontroller runs a <em>bootloader</em></li>
            <li>Etc.</li>
          </ul>
        </section>
        
        <section>
          <h4>Debugging</h4>
          <ul>
            <li>The development computer can control the execution of the application running in the microcontroller</li>
            <li>Requires a debug interface on the microcontroller board and a serial link</li>
          </ul>
        </section>
        
        <section>
          <ul>
            <li>Every microcontroller manufacturer: full development environnement</li>
            <li>Often free</li>
            <li>Often based on Open Source software (Eclipse, gcc, openOCD, etc.)</li>
          </ul>
        </section>
        
        <!-- -------------------- Exercise 01: Hello World ---------------------------------------- -->
        
        <section id="exercise01">
          <h3>Exercise 01</h3>
          <p>Build and run an <em>Hello World</em> application for the EFR32xG24 Dev Kit</p>
        </section>
        
        <section>
          <h4>EFR32MG24</h4>
          <img src="images/efr32mg24-block-diagram.png">
          <div class="pbverysmall">Source: 
            <a
              href="https://www.silabs.com/documents/public/data-sheets/efr32mg24-datasheet.pdf"
              title="EFR32MG24 Datasheet"
              target="_blank">EFR32MG24 Datasheet</a></div>
        </section>
        
        <section>
          <h4>EF32xG24 Dev Kit</h4>
          <img src="images/efr32bg24-dev-kit-annotated-photo.png" height="400">
          <div class="pbverysmall">Source: 
            <a
              href="https://www.silabs.com/documents/public/user-guides/ug524-brd2601b-user-guide.pdf"
              title="xG24 Dev Kit User's Guide" 
              target="_blank">xG24 Dev Kit User's Guide</a></div>
        </section>
        
        <section>
          <h4>Reference documentation</h4>
          <ul>
            <li>Microcontroller:
              <ul>
                <li><a href="https://www.silabs.com/documents/public/data-sheets/efr32mg24-datasheet.pdf"
                       target="_blank">
                  EF32MG24 Wireless SoC Family Data Sheet (132 pages)</a></li>
                <li><a href="https://www.silabs.com/documents/public/reference-manuals/efr32xg24-rm.pdf"
                       target="_blank">
                  EFR32xG24 Wireless SoC Reference Manual (1152 pages)</a></li>
              </ul>
            </li>
            <li>Board:
              <ul>
                <li><a href="https://www.silabs.com/documents/public/user-guides/ug524-brd2601b-user-guide.pdf"
                       target="_blank">
                  xG24 Dev Kit User's Guide</a></li>
                <li><a href="https://www.silabs.com/documents/public/schematic-files/BRD2601B-A01-schematic.pdf"
                       target="_blank">
                  Schematic - Revision A01</a></li>
              </ul>
            </li>
            <li>Sofware:
              <ul>
                <li><a href="https://docs.silabs.com/" target="_blank">Developer Documentation</a>:
                  <ul>
                    <li><a href="https://docs.silabs.com/simplicity-studio-5-users-guide/latest/ss-5-users-guide-overview/"
                           target="_blank"">Simplicity Studio 5 User's Guide</a></li>
                    <li><a href="https://docs.silabs.com/gecko-platform/5.0.1/platform-overview/"
                           target="_blank">Platform (SDK)</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </section>
        
        <section>
          <h4>Development environments</h4>
          <p>Several possibilities:</p>
          <ul>
            <li>Simplicity Studio v5 (SSv5) - based upon Eclipse IDE</li>
            <li>VS Code + extension</li>
            <li>...</li>
          </ul>
          <p class="fragment">We will use SSv5.</p>
        </section>
        
        <section>
          <h4>SSv5</h4>
          <div class="r-stack">
            <div class="fragment fade-out" data-fragment-index="0">
              <img src="images/efr3232DevEnvironmentWithoutCallouts.png">
            </div>
            <div class="fragment fade-in-then-out" data-fragment-index="0">
              <img src="images/efr3232DevEnvironmentCallouts1.png">
            </div>
          </div>
        </section>
        
        <section>
          <h4>Exercise 01</h4>
          <ul>
            <li>Using <em>git</em>, clone the <a href="https://github.com/PascalBod/RTOS-presentation"
                                          target="_blank">
              <code>RTOS-presentation</code> GitHub repository</a></li>
            <li>Follow the instructions provided by the 
                <a href="https://github.com/PascalBod/RTOS-presentation/blob/main/exercises/01-HelloWorld/README.md"
                   target="_blank"><code>RTOS-presentation/exercises/01-HelloWorld/README.md</code></a>
                file.</li>
          </ul>
        </section>
        
        <!-- -------------------- Peripherals ---------------------------------------- -->
        
        <section id="peripherals">
          <h3>Peripherals</h3>
        </section>

        <section>
          <p><b>Peripheral</b>: a piece of equipment that can be connected to the microcontroller
             or to the microcontroller board.</p>
        </section>
        
        <section>
          <h4>Sensors</h4>
          <ul>
            <li>Pressure</li>
            <li>Temperature</li>
            <li>Light level</li>
            <li>Magnetic field</li>
            <li>Gas flow</li>
            <li>Tilt</li>
            <li>Acceleration</li>
            <li>Contact</li>
            <li>etc.</li>
          </ul>
        </section>

        <section>
          <h4>Actuators</h4>
          <ul>
            <li>Relay</li>
            <li>Motor</li>
            <li>Stepper motor</li>
            <li>Servomotor</li>
            <li>etc.</li>
          </ul>
        </section>

        <section>
          <h4>Other peripherals</h4>
          <ul>
            <li>Printer</li>
            <li>Display</li>
            <li>OBD connector (On-Board Diagnostics)</li>
            <li>RFID tag reader</li>
            <li>Computer (!)</li>
            <li>etc.</li>
          </ul>
        </section>
        
        <!-- -------------------- Interfaces ---------------------------------------- -->
        
        <section id="interfaces">
          <h3>Interfaces</h3>
        </section>
        
        <section>
          <p><b>Interface</b>: a means (hardware and software) of connecting a peripheral to the microcontroller or 
             to the microcontroller board.</p>
        </section>
        
        <section id="gpioInterface">
          <h4>GPIO (General Purpose digital Input Output)</h4>
          <ul>
            <li>Microcontroller pin which can handle a digital signal</li>
            <li class="fragment">Signal voltage for bit value 0 is 0 V</li>
            <li class="fragment">Signal voltage for bit value 1 depends on microcontroller. Usually: supply voltage (e.g. 3.3 V)
            <li class="fragment">Can be configured either as an input or as an output (with some different modes)</li>
          </ul>
        </section>
        
        <section>
          <ul>
            <li>On a microcontroller: usually several "ports" of GPIOs</li>
            <li>Ports are labelled, by a letter or by a number</li>
            <li>In a given port, each GPIO is numbered</li>
          </ul>
          <p>For instance: PA00 to PA07, PB00 to PB03, PC00 to PC09 and PD00 to PD05.</p>
        </section>
        
        <section>
          <h4>GPIO as an output</h4>
          <div class="row">
            <div class="column">
              <img src="images/interfacesGpioOutput01.png" height="400">
            </div>
            <div class=column>
              <ul>
                <li class="fragment">When PD02 is at 1 (i.e. VMCU), the LED is off, as no current can flow through it</li>
                <li class="fragment">When PD02 is at 0 (i.e. 0 V), the LED is on, as some current can flow through it</li>
              </ul>
              <p class="fragment">Easy, isn't it? &#x1F642;</p>
            </div>
          </div>
          <div class="pbsmaller">Note: component references are taken from the Dev Kit board.</div>
          <div class="pbverysmall">EDA (Electronic Design Automation) tool: <a href="https://www.kicad.org/" title="KiCad" target="_blank">
               KiCad</a></div>
        </section>
        
        <section>
          <h4>Physical world has some constraints - 1/2</h4>
          <div class="row">
            <div class="column">
              <img src="images/interfacesGpioOutput01.png" height="400">
            </div>
            <div class="column">
              <ul>
                <li>Current through the LED should not be greater than a value depending on the LED (for instance: 1.5 mA)</li>
                <li class="fragment">A resistor in series with the LED can limit the current. Resistor value is given by Ohm's law: 
             <code>R137 = VMCU / Imax</code></li>
                <li class="fragment">We have <code>VMCU = 3.3 V</code> and decide on <code>Imax = 1.5 mA</code></li>
                <li class="fragment">&rArr; <code>R137 = 2.2 k&#8486;</code></li>
              </ul>
            </div>
          </div>
        </section>
        
        <section>
          <h4>Physical world has some constraints - 2/2</h4>
          <p>The LED current flows into the microcontroller. A GPIO can't accept more than a given value 
             (provided by the microcontroller data sheet).</p>
          <p class="fragment">For the EFR32MG24, maximum value is 50 mA. As R137 limits the current to 1.5 mA, we are OK.</p>
          <p class="fragment">Another limit: total maximum value for all GPIO pins. For the EFR32MG24: 200 mA.</p>
          <p class="fragment">Note: the GPIO is configured as an output, but the current flows INTO the microcontroller.</p>
        </section>
        
        <section>
          <h4>GPIO as an input - 1/5</h4>
          <div class="row">
            <div class="column">
              <img src="images/interfacesGpioInput01.png" height="400">
            </div>
            <div class=column>
              <ul>
                <li class="fragment">When the switch is closed, PB02 is set to 0 (GND = 0 V)</li>
                <li class="fragment">When the switch is open, PB02 is not set. It is "floating"</li>
              </ul>
              <p class="fragment">How to set PB02 to 1 when the switch is open?</p>
            </div>
          </div>
          <div class="pbsmaller">Note: component references are taken from the Dev Kit board.</div>
          <div class="pbverysmall">EDA (Electronic Design Automation) tool: <a href="https://www.kicad.org/" title="KiCad" target="_blank">
               KiCad</a></div>
        </section>

        <section>
          <h4>GPIO as an input - 2/5</h4>
          <div class="row">
            <div class="column">
              <img src="images/interfacesGpioInput02.png" height="400">
            </div>
            <div class=column>
              <ul>
                <li>R140 ensures that PB02 is set to 1 when the switch is open</li>
                <li class="fragment">It is named <em>pullup resistor</em></li>
                <li class="fragment">The resistor value is large enough to get a low current through it (but beware: it is not null)</li>
                <li class="fragment">If the switch was connected to VMCU instead of GND, we would use a <em>pulldown resistor</em></li>
              </ul>
            </div>
          </div>
          <div class="pbverysmall">EDA (Electronic Design Automation) tool: <a href="https://www.kicad.org/" title="KiCad" target="_blank">
               KiCad</a></div>
        </section>

        <section>
          <h4>GPIO as an input - 3/5</h4>
          <div class="row">
            <div class="column">
              <img src="images/interfacesGpioInput03.png" height="400">
            </div>
            <div class=column>
              <ul>
                <li>The <a href="https://www.silabs.com/documents/public/schematic-files/BRD2601B-A01-schematic.pdf"
                       target="_blank">board schematic</a> shows an additional resistor, R141. What is its purpose?</li>
                <li class="fragment">If the GPIO was configured as an output (bug), set to 1, and the switch was closed: short-circuit</li>
                <li class="fragment">R141 limits the current in such a case</li>
              </ul>
            </div>
          </div>
          <div class="pbverysmall">EDA (Electronic Design Automation) tool: <a href="https://www.kicad.org/" title="KiCad" target="_blank">
               KiCad</a></div>
        </section>

        <section>
          <h4>GPIO as an input - 4/5</h4>
          <div class="row">
            <div class="column">
              <img src="images/interfacesGpioInput04.png" height="400">
            </div>
            <div class=column>
              <ul>
                <li>The <a href="https://www.silabs.com/documents/public/schematic-files/BRD2601B-A01-schematic.pdf"
                       target="_blank">board schematic</a> shows a capacitor, C142. What is its purpose?</li>
              </ul>
            </div>
          </div>
          <div class="pbverysmall">EDA (Electronic Design Automation) tool: <a href="https://www.kicad.org/" title="KiCad" target="_blank">
               KiCad</a></div>
        </section>
        
        <section>
          <h4>What really happens when closing a switch</h4>
          <img src="images/0059-Switch_Debouncing_Figure_1.webp" height="300">
          <p class="pbcenter">Vertical: 1 V / division - Horizontal: 1 ms / division</p>
          <div class="pbverysmall">Source: <a href="https://circuitcellar.com/resources/quickbits/switch-debouncing/" title="circuit cellar" 
               target="_blank">
               circuit cellar</a></div>
        </section>
        
        <section>
          <h4>GPIO as an input - 5/5</h4>
          <div class="row">
            <div class="column">
              <img src="images/interfacesGpioInput04.png" height="400">
            </div>
            <div class=column>
              <ul>
                <li>C142 "fills in" the gaps / filters out the highest frequencies</li>
                <li class="fragment">&rArr; <em>debouncing</em></li>
                <li class="fragment">Debouncing can also be done in software</li>
              </ul>
            </div>
          </div>
          <div class="pbverysmall">EDA (Electronic Design Automation) tool: <a href="https://www.kicad.org/" title="KiCad" target="_blank">
               KiCad</a></div>
        </section>
        
        <section>
          <h4>Voltage and current adaptation</h4>
          <p>If peripheral voltage is different from microcontroller voltage, or if it requires
             more current than what the microcontroller can provide, or if regulations require 
             some specific protections, adaptation is required:</p>
          <ul>
            <li>Optocoupler</li>
            <li>Relay</li>
            <li>Etc.</li>
          </ul>
        </section>
        
        <!-- -------------------- Practice: GPIO Input ---------------------------------------- -->
        
        <section id="exercise02">
          <h4>Exercise 02</h4>
          <p>Display a message when a button is pushed or released</p>
          <ul>
            <li>Follow the instructions provided by the 
                <a href="https://github.com/PascalBod/RTOS-presentation/blob/main/exercises/02-GpioInput/README.md"
                   target="_blank""><code>RTOS-presentation/exercises/02-GpioInput/README.md</code></a>
                file.</li>
          </ul>
        </section>
        
        <!-- -------------------- Practice: GPIO Output ---------------------------------------- -->

        <section id="exercise03">
          <h4>Exercise 03</h4>
          <p>Make a LED blink</p>
          <ul>
            <li>Follow the instructions provided by the 
                <a href="https://github.com/PascalBod/RTOS-presentation/blob/main/exercises/03-GpioOutput/README.md"
                   target="_blank""><code>RTOS-presentation/exercises/03-GpioOutput/README.md</code></a>
                file.</li>
          </ul>
        </section>
        
      </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
      hash: true,
      slideNumber: 'c/t',
      // Scroll view inhibited until arrow keys can be used.
      //view: 'scroll',
      //scrollProgress: true,
      // Learn about plugins: https://revealjs.com/plugins/
      plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
      });
    </script>
  </body>
</html>
